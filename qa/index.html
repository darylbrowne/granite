<!DOCTYPE html>
<html>
  <head>
    <script src="../js/granite.js"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Granite Block Test Slab</title>
    <script src="https://kit.fontawesome.com/5f9385ccbf.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous" />
   <link rel="stylesheet" type="text/css" href="https://addapptation.blob.core.windows.net/addapptation-stylesheets/fontawesome-pro-5.10.0-11-web/css/all.min.css">
    <script>
      var searchParams = new URLSearchParams(window.location.search);

      function runTest (jsonBlock, jsonTheme) {
        var id = jsonBlock.id;
        var jsonBlock = JSON.stringify(jsonBlock);
        var jsonTheme = JSON.stringify(jsonTheme);
        var micro = document.createElement('div');
        micro.setAttribute('id', id);
        micro.setAttribute('data-granite-block', jsonBlock);
        micro.setAttribute('data-granite-theme', jsonTheme);
        var testContent = document.createTextNode("");
        micro.appendChild(testContent);
        document.body.appendChild(micro);
      }
      var arrFinals = [];
      var arrTests = searchParams.getAll("show");
      for (var i = arrTests.length; i--;) {
          console.log(arrTests[i]);
          if (arrTests[i].includes(',')) {
              console.log('1: ' + arrTests[i]);
              let arrSub = arrTests[i].split(',');
              arrFinals = arrFinals.concat(arrSub);
          } else {
            console.log('2: ' + arrTests[i]);
            arrFinals.push(arrTests[i]);
          }
      }

      console.log(arrFinals);

      for (let p of arrFinals) {
        console.log(p);
             import(`./${p}.js`)
                .then(x => runTest(x.jsonBlock, x.jsonTheme))
      }
    </script>
  </head>
  <body>
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
  </body>
</html>
